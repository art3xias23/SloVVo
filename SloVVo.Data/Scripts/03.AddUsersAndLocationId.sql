ALTER TABLE [dbo].[Books] DROP CONSTRAINT [PK_dbo.Books]
CREATE TABLE [dbo].[Users] (
    [UserId] [int] NOT NULL IDENTITY,
    [Forename] [nvarchar](4000) NOT NULL,
    [Surname] [nvarchar](4000) NOT NULL,
    [Telephone] [int],
    [Address] [nvarchar](4000) NOT NULL,
    [Location] [nvarchar](4000) NOT NULL,
    CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([UserId])
)
CREATE TABLE [dbo].[UserBooks] (
    [User_UserId] [int] NOT NULL,
    [Book_BibioId] [int] NOT NULL,
    [Book_ShelfId] [int] NOT NULL,
    [Book_BookId] [int] NOT NULL,
    [Book_LocationId] [int] NOT NULL,
    CONSTRAINT [PK_dbo.UserBooks] PRIMARY KEY ([User_UserId], [Book_BibioId], [Book_ShelfId], [Book_BookId], [Book_LocationId])
)
CREATE INDEX [IX_User_UserId] ON [dbo].[UserBooks]([User_UserId])
CREATE INDEX [IX_Book_BibioId_Book_ShelfId_Book_BookId_Book_LocationId] ON [dbo].[UserBooks]([Book_BibioId], [Book_ShelfId], [Book_BookId], [Book_LocationId])
ALTER TABLE [dbo].[Books] ADD [LocationId] [int] NOT NULL DEFAULT 0
ALTER TABLE [dbo].[Books] ADD CONSTRAINT [PK_dbo.Books] PRIMARY KEY ([BibioId], [ShelfId], [BookId], [LocationId])
ALTER TABLE [dbo].[UserBooks] ADD CONSTRAINT [FK_dbo.UserBooks_dbo.Users_User_UserId] FOREIGN KEY ([User_UserId]) REFERENCES [dbo].[Users] ([UserId]) ON DELETE CASCADE
ALTER TABLE [dbo].[UserBooks] ADD CONSTRAINT [FK_dbo.UserBooks_dbo.Books_Book_BibioId_Book_ShelfId_Book_BookId_Book_LocationId] FOREIGN KEY ([Book_BibioId], [Book_ShelfId], [Book_BookId], [Book_LocationId]) REFERENCES [dbo].[Books] ([BibioId], [ShelfId], [BookId], [LocationId]) ON DELETE CASCADE
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'202107251534432_Adding User And LocationId', N'SloVVo.Data.Migrations.Configuration',  0x1F8B0800000000000400DD5C4B6FE33610BE17E87F10742CB2969DF4D006F62EB24E5204DD248B381BB4278391685B58BD2A514182A2BFAC87FEA4FE85927A507C4AA2FC48BAD84B42718633C3E1CC70F865FFFDFB9FE987E730B09E609AF97134B327A3B16DC1C88D3D3F5ACFEC1CADDEFD647F78FFFD77D30B2F7CB61EEA7927641EA68CB299BD412839759CCCDDC01064A3D077D3388B5768E4C6A103BCD8391E8F7F76261307621636E66559D3BB3C427E088B5FF0AFF33872618272105CC71E0CB26A1C7F59145CAD1B10C22C012E9CD98B207E788847E7008111A643F019D9D659E0032CCA02062BDB0251142380B0A0A75F32B840691CAD17091E00C1FD4B02F1BC150832582970DA4CEFABCBF898E8E23484352B37CF501C1A329C9C54C67144F24126B6A9F1B0F92EB099D10BD1BA30E1CC3ECBD1264E6D4B5CEA741EA4641A6FDF72374625D191C57C3AA2BE805D86FC3BB2E67980F214CE2298A3140447D6E7FC31F0DD5FE1CB7DFC1546B3280F0256382C1EFEC60DE0A1CF699CC014BDDCC11527F295675B0E4FED88E49458A22C55BB8AD0C9B16DDD6041C06300A91F306658A03885BFC008A60041EF334008A6781BAF3C5858529241B922F9B95E13BB1F3E4AB6750D9E3FC1688D36331BFF685B97FE33F4EA914A8E2F918F4F1E2642690E15720A6BDF80277F5D882D48F1318EBF66B6750783E26BB6F193F26C543BB9AC265CA67178170754EE727CB988F3D4250AC48A8FF7205D43C4CB32751A3F6BF53EC2C2D0F708C96B79DE47FFD18F65C753CE5D6CB07D7BCE253AF59CFA29760B1B0D717F2AFEB6DE7F1347B2F7098B51FD0FB1586DC043ACC5EEC0A174EB082038DAF70A207D6295A456C7364357698C76AADF21486F57E5A9AC32DBD6D1B16F30AC33DED06858073C6534AC43655F612AF329A5211C977442230D3B2EC566EEA32A36B74983ABA3549D27C817D92ECDA86415E693CA26BD3304D5DF28495454AF95279843611AA375E7698F354AB564478C99F48C317B28527A1D04D10195A764900B125736F43F42F25ACE47D61EE27935DDA1DCEE1253477B2A8C7754C2E4E9DB16F01E0630D91413B95DDB0DF733CF4B6196BD5DF5EB4AEC0D493820BA75A65631C52BB26E9FB8769665B1EB17AB3332D1B8CAEB711179565BB551DABB0ECED8E43898F9090E5F78E199FD8364170D3F1AB41B7E34CEF32CC7A3D144E28A831E4C49B401C11CDB1487513F427284F423D74F40D02280406396D489C9E922E2977398C08844C416736EBD3A5D4408F95DF6993A8C53B4FB0AE3A5BA9D55B96CB3AF6516EDEF27AADAD2C8EB0C94E3EA7E9D40EA964823527DAFE8E1B71AA6C3F41C7A0E54FAF4F1445DFBCDE818A8F4DE76F19D9F82328E929E32A680697D128BAA8E1475B4DB2CD586D879ABF230AB328CE80084F302224E2D9C009AD02D7895E4413C832A7F48E4A5FF741057B145454FA371078BEAE628D197A75E2066CCCD6BD014F9CC14D52540DCFB8E7445A5A58692BCA72341311C1A6B891536AF570F9DD9D42F6BAC0BB95D419791B5DA96166D1561B6CB5A0314E51B2BB2AAFA00DC1D821971E9316A51581971B750B92EB7689868DEAA9CF2B1AA7ED47234AF5AD36B9024B870655EB9AA116B513E71CDDF2DCC9F7EC29287E3668A17202A2D5D0917B9600D85AF78692CE9A59F668804BC47404AE3B9174AD3E4A0A88917F57A7CDC93B7AB8E23F57CF2331B7FB9F7BE3A4ACA19A422BFC4BA8524FB14B5BCE4313261F1D20802906A7BA4F338C8C3A82B2B75712A9B2E32AF725CE63675048DA42C28994E706471277AED93EE609AED52918CCCF7484DA6B32B7DE4608DAA7DB8D1F3A1EF172C1FEDA34E8B3CD5D304278EE6BD47CF857D746039E99F83BA64923DAF1935F5E25D9C07E682C3595C7FEFD1F3523C2FB03C159FDFCC49A3D5C5B6874D532AF5386F5ACA436C1DD78C56707B6381B12CB0B6DDABA24A36DF283599CEB2757F9735AABA57DCC6A5E9DAB27C9A51839DAEBBABDC2ED783FDF9304D509613336C10CEEA962717CDEA41F370AD0ED6AFE1BF7CFD2A3B715D9B773B6A3D53E58DAA544D6A6F852B76351E8C7C78A973646216BABA9160DAA68441D5416E922DA58741E1515E4AF5D58759EDB1D4172066E547C1ACAD06D1DB5FBC52C95E2BDDACC429F4CCD01B9670939A56B79A6E10A174CD29A7D81696FDC9F78A2BCE4B8660589E87C51FC13CF0F1296D265C83C85FC10C958F77F6F178722CC010DF0E24D0C9322F50DC0AFBE002AF220F3ECFEC3FADBF5E17BBE713E3773E4176BD4677C2F5A22790BA1B9072AF4A3F8EC963782BEF6D2170DB99F9DB02AA155B6DB89302FC6C080B1E543684830C151B2A47A74B1EF31E3904EF55C8A6774442746A5DFDB6ACE98EACDB1407BE536B8C9DD4706D09E6D277714AB8CDEA5AF859AFD32EAFB00334D376E77D9780A3BD045605C64869EBC9EE02AB06B6B39DA17703AED98B89453CCDD0CCA5D83C1E07B33BC6127E45088FBDA2188F52D99D7022BA64EF9580FA02D5DF2FF597207522D75F4D7404A6A582F69EA19BBF4DD1C099C02CA930A4BAB4D23B532F55C54B0F1958DA256BED2563C9A560A5EDA555D5497B977632D8B67249B677618F870AABA9FEF62EF049A7C03B8688D1AA66208C8B7F7B3F14FE45DF20DF27F6EB7F06F652F6E704F84027CC6B22B5046FA3739CFA11B4CEDCB2073207990B3CF95C91F651DBDA92C334837B711A4DA7BE6FA168E42EBA86EA8002E0C04EA3EA9D9A9EF26FC8697A6F625BAFD8A07163D4BA316CDEECCF833BBBE5A645A979593AA4303DD0E93280A86E8F4A3D641AD64277F6843CEDED8F6F006A2A83AFC41D53C1485B50A4E5ABC6CCF61E63BCBF657DA801CD2921A65A84A98AB11A49A7019FB6614F55CCB5284C1532550B4C5571566226956C3516693EE9D8AB2DB34F58AC60650EE7D1058695E0913B45BE521C671B0056F34C2C15A22238A20BF92AA9D70CEE52C51A66DAAAA2FAC1D9742F0EAAE24E61BD0A24EF5E5DD300B82B3F23E350CFFC8F3538C964FEBA6141FEFF9AA83C5D0DD37ACE55B48AEB6C2348544F11BA09D710010F6780B314F92BE022FCD9855956FCADDB0308723CE5227C84DE55749BA324475865183E06DC5F60929CD5B67E814EE6659EDE264588DD850A584C1FAB006FA38FB91F7854EE4B457342C38224C3AA5D4EF61291B6F9FA857292FF1C4FC7A8321FCDE1F7304C02CC2CBB8D16E0090E910D9FA94F700DDC971A0DA067D2BD11BCD9A7E73E58A720CC2A1E0D3DFE15FBB0173EBFFF0FA1086107B8490000 , N'6.4.4')

