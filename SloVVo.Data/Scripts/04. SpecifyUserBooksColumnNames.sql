ALTER TABLE [dbo].[Books] DROP CONSTRAINT [PK_dbo.Books]
CREATE TABLE [dbo].[Users] (
    [UserId] [int] NOT NULL IDENTITY,
    [Forename] [nvarchar](4000) NOT NULL,
    [Surname] [nvarchar](4000) NOT NULL,
    [Telephone] [int],
    [Address] [nvarchar](4000) NOT NULL,
    [Location] [nvarchar](4000) NOT NULL,
    CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([UserId])
)
CREATE TABLE [dbo].[UserBooks] (
    [User_UserId] [int] NOT NULL,
    [Book_BibioId] [int] NOT NULL,
    [Book_ShelfId] [int] NOT NULL,
    [Book_BookId] [int] NOT NULL,
    [Book_LocationId] [int] NOT NULL,
    CONSTRAINT [PK_dbo.UserBooks] PRIMARY KEY ([User_UserId], [Book_BibioId], [Book_ShelfId], [Book_BookId], [Book_LocationId])
)
CREATE INDEX [IX_User_UserId] ON [dbo].[UserBooks]([User_UserId])
CREATE INDEX [IX_Book_BibioId_Book_ShelfId_Book_BookId_Book_LocationId] ON [dbo].[UserBooks]([Book_BibioId], [Book_ShelfId], [Book_BookId], [Book_LocationId])
ALTER TABLE [dbo].[Books] ADD [LocationId] [int] NOT NULL DEFAULT 0
ALTER TABLE [dbo].[Books] ADD CONSTRAINT [PK_dbo.Books] PRIMARY KEY ([BibioId], [ShelfId], [BookId], [LocationId])
ALTER TABLE [dbo].[UserBooks] ADD CONSTRAINT [FK_dbo.UserBooks_dbo.Users_User_UserId] FOREIGN KEY ([User_UserId]) REFERENCES [dbo].[Users] ([UserId]) ON DELETE CASCADE
ALTER TABLE [dbo].[UserBooks] ADD CONSTRAINT [FK_dbo.UserBooks_dbo.Books_Book_BibioId_Book_ShelfId_Book_BookId_Book_LocationId] FOREIGN KEY ([Book_BibioId], [Book_ShelfId], [Book_BookId], [Book_LocationId]) REFERENCES [dbo].[Books] ([BibioId], [ShelfId], [BookId], [LocationId]) ON DELETE CASCADE
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'202107251534432_Adding User And LocationId', N'SloVVo.Data.Migrations.Configuration',  0x1F8B0800000000000400DD5C4B6FE33610BE17E87F10742CB2969DF4D006F62EB24E5204DD248B381BB4278391685B58BD2A514182A2BFAC87FEA4FE85927A507C4AA2FC48BAD84B42718633C3E1CC70F865FFFDFB9FE987E730B09E609AF97134B327A3B16DC1C88D3D3F5ACFEC1CADDEFD647F78FFFD77D30B2F7CB61EEA7927641EA68CB299BD412839759CCCDDC01064A3D077D3388B5768E4C6A103BCD8391E8F7F76261307621636E66559D3BB3C427E088B5FF0AFF33872618272105CC71E0CB26A1C7F59145CAD1B10C22C012E9CD98B207E788847E7008111A643F019D9D659E0032CCA02062BDB0251142380B0A0A75F32B840691CAD17091E00C1FD4B02F1BC150832582970DA4CEFABCBF898E8E23484352B37CF501C1A329C9C54C67144F24126B6A9F1B0F92EB099D10BD1BA30E1CC3ECBD1264E6D4B5CEA741EA4641A6FDF72374625D191C57C3AA2BE805D86FC3BB2E67980F214CE2298A3140447D6E7FC31F0DD5FE1CB7DFC1546B3280F0256382C1EFEC60DE0A1CF699CC014BDDCC11527F295675B0E4FED88E49458A22C55BB8AD0C9B16DDD6041C06300A91F306658A03885BFC008A60041EF334008A6781BAF3C5858529241B922F9B95E13BB1F3E4AB6750D9E3FC1688D36331BFF685B97FE33F4EA914A8E2F918F4F1E2642690E15720A6BDF80277F5D882D48F1318EBF66B6750783E26BB6F193F26C543BB9AC265CA67178170754EE727CB988F3D4250AC48A8FF7205D43C4CB32751A3F6BF53EC2C2D0F708C96B79DE47FFD18F65C753CE5D6CB07D7BCE253AF59CFA29760B1B0D717F2AFEB6DE7F1347B2F7098B51FD0FB1586DC043ACC5EEC0A174EB082038DAF70A207D6295A456C7364357698C76AADF21486F57E5A9AC32DBD6D1B16F30AC33DED06858073C6534AC43655F612AF329A5211C977442230D3B2EC566EEA32A36B74983ABA3549D27C817D92ECDA86415E693CA26BD3304D5DF28495454AF95279843611AA375E7698F354AB564478C99F48C317B28527A1D04D10195A764900B125736F43F42F25ACE47D61EE27935DDA1DCEE1253477B2A8C7754C2E4E9DB16F01E0630D91413B95DDB0DF733CF4B6196BD5DF5EB4AEC0D493820BA75A65631C52BB26E9FB8769665B1EB17AB3332D1B8CAEB711179565BB551DABB0ECED8E43898F9090E5F78E199FD8364170D3F1AB41B7E34CEF32CC7A3D144E28A831E4C49B401C11CDB1487513F427284F423D74F40D02280406396D489C9E922E2977398C08844C416736EBD3A5D4408F95DF6993A8C53B4FB0AE3A5BA9D55B96CB3AF6516EDEF27AADAD2C8EB0C94E3EA7E9D40EA964823527DAFE8E1B71AA6C3F41C7A0E54FAF4F1445DFBCDE818A8F4DE76F19D9F82328E929E32A680697D128BAA8E1475B4DB2CD586D879ABF230AB328CE80084F302224E2D9C009AD02D7895E4413C832A7F48E4A5FF741057B145454FA371078BEAE628D197A75E2066CCCD6BD014F9CC14D52540DCFB8E7445A5A58692BCA72341311C1A6B891536AF570F9DD9D42F6BAC0BB95D419791B5DA96166D1561B6CB5A0314E51B2BB2AAFA00DC1D821971E9316A51581971B750B92EB7689868DEAA9CF2B1AA7ED47234AF5AD36B9024B870655EB9AA116B513E71CDDF2DCC9F7EC29287E3668A17202A2D5D0917B9600D85AF78692CE9A59F668804BC47404AE3B9174AD3E4A0A88917F57A7CDC93B7AB8E23F57CF2331B7FB9F7BE3A4ACA19A422BFC4BA8524FB14B5BCE4313261F1D20802906A7BA4F338C8C3A82B2B75712A9B2E32AF725CE63675048DA42C28994E706471277AED93EE609AED52918CCCF7484DA6B32B7DE4608DAA7DB8D1F3A1EF172C1FEDA34E8B3CD5D304278EE6BD47CF857D746039E99F83BA64923DAF1935F5E25D9C07E682C3595C7FEFD1F3523C2FB03C159FDFCC49A3D5C5B6874D532AF5386F5ACA436C1DD78C56707B6381B12CB0B6DDABA24A36DF283599CEB2757F9735AABA57DCC6A5E9DAB27C9A51839DAEBBABDC2ED783FDF9304D509613336C10CEEA962717CDEA41F370AD0ED6AFE1BF7CFD2A3B715D9B773B6A3D53E58DAA544D6A6F852B76351E8C7C78A973646216BABA9160DAA68441D5416E922DA58741E1515E4AF5D58759EDB1D4172066E547C1ACAD06D1DB5FBC52C95E2BDDACC429F4CCD01B9670939A56B79A6E10A174CD29A7D81696FDC9F78A2BCE4B8660589E87C51FC13CF0F1296D265C83C85FC10C958F77F6F178722CC010DF0E24D0C9322F50DC0AFBE002AF220F3ECFEC3FADBF5E17BBE713E3773E4176BD4677C2F5A22790BA1B9072AF4A3F8EC963782BEF6D2170DB99F9DB02AA155B6DB89302FC6C080B1E543684830C151B2A47A74B1EF31E3904EF55C8A6774442746A5DFDB6ACE98EACDB1407BE536B8C9DD4706D09E6D277714AB8CDEA5AF859AFD32EAFB00334D376E77D9780A3BD045605C64869EBC9EE02AB06B6B39DA17703AED98B89453CCDD0CCA5D83C1E07B33BC6127E45088FBDA2188F52D99D7022BA64EF9580FA02D5DF2FF597207522D75F4D7404A6A582F69EA19BBF4DD1C099C02CA930A4BAB4D23B532F55C54B0F1958DA256BED2563C9A560A5EDA555D5497B977632D8B67249B677618F870AABA9FEF62EF049A7C03B8688D1AA66208C8B7F7B3F14FE45DF20DF27F6EB7F06F652F6E704F84027CC6B22B5046FA3739CFA11B4CEDCB2073207990B3CF95C91F651DBDA92C334837B711A4DA7BE6FA168E42EBA86EA8002E0C04EA3EA9D9A9EF26FC8697A6F625BAFD8A07163D4BA316CDEECCF833BBBE5A645A979593AA4303DD0E93280A86E8F4A3D641AD64277F6843CEDED8F6F006A2A83AFC41D53C1485B50A4E5ABC6CCF61E63BCBF657DA801CD2921A65A84A98AB11A49A7019FB6614F55CCB5284C1532550B4C5571566226956C3516693EE9D8AB2DB34F58AC60650EE7D1058695E0913B45BE521C671B0056F34C2C15A22238A20BF92AA9D70CEE52C51A66DAAAA2FAC1D9742F0EAAE24E61BD0A24EF5E5DD300B82B3F23E350CFFC8F3538C964FEBA6141FEFF9AA83C5D0DD37ACE55B48AEB6C2348544F11BA09D710010F6780B314F92BE022FCD9855956FCADDB0308723CE5227C84DE55749BA324475865183E06DC5F60929CD5B67E814EE6659EDE264588DD850A584C1FAB006FA38FB91F7854EE4B457342C38224C3AA5D4EF61291B6F9FA857292FF1C4FC7A8321FCDE1F7304C02CC2CBB8D16E0090E910D9FA94F700DDC971A0DA067D2BD11BCD9A7E73E58A720CC2A1E0D3DFE15FBB0173EBFFF0FA1086107B8490000 , N'6.4.4')

EXECUTE sp_rename @objname = N'dbo.UserBooks', @newname = N'UserBooks1', @objtype = N'OBJECT'
IF object_id('[PK_dbo.UserBooks]') IS NOT NULL BEGIN
    EXECUTE sp_rename @objname = N'[PK_dbo.UserBooks]', @newname = N'PK_dbo.UserBooks1', @objtype = N'OBJECT'
END
CREATE TABLE [dbo].[UserBooks] (
    [BibioId] [int] NOT NULL,
    [BookId] [int] NOT NULL,
    [LocationId] [int] NOT NULL,
    [ShelfId] [int] NOT NULL,
    [UserId] [int] NOT NULL,
    CONSTRAINT [PK_dbo.UserBooks] PRIMARY KEY ([BibioId], [BookId], [LocationId], [ShelfId], [UserId])
)
CREATE INDEX [IX_BibioId_BookId_LocationId_ShelfId] ON [dbo].[UserBooks]([BibioId], [BookId], [LocationId], [ShelfId])
CREATE INDEX [IX_UserId] ON [dbo].[UserBooks]([UserId])
ALTER TABLE [dbo].[UserBooks] ADD CONSTRAINT [FK_dbo.UserBooks_dbo.Books_BibioId_BookId_LocationId_ShelfId] FOREIGN KEY ([BibioId], [BookId], [LocationId], [ShelfId]) REFERENCES [dbo].[Books] ([BibioId], [ShelfId], [BookId], [LocationId]) ON DELETE CASCADE
ALTER TABLE [dbo].[UserBooks] ADD CONSTRAINT [FK_dbo.UserBooks_dbo.Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[Users] ([UserId]) ON DELETE CASCADE
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'202107251600155_Specifying column names for UserBooks', N'SloVVo.Data.Migrations.Configuration',  0x1F8B0800000000000400ED1DCB6EE4B8F11E20FF20E818782DB72787C4E8DE85A7671C18198F07D3DE41726AD012BB2DAC1E1D89326C04F9B21CF249F985502F8A6F917AB47B6783B9D81259AC2AD65B559EFFFEFB3FCB9F5EE2C87986591EA6C9CA5D9C5FB80E4CFC340893FDCA2DD0EE873FB93FFDF8FBDF2D3F06F18BF3AD5DF7AE5C877726F9CA7D42E870E579B9FF0463909FC7A19FA579BA43E77E1A7B2048BDCB8B8B3F7B8B8507310817C3729CE5D72241610CAB5FF0AFEB34F1E1011520BA4B0318E5CD73FC665341753E8318E607E0C395BB89D26FDFD2F30F008173BC0FC117E43AD75108302A1B18ED5C0724498A00C2885EFD9CC30DCAD264BF39E007207A783D40BC6E07A21C36045C75CB4D69B9B82C69F1BA8D2D28BFC8511A5B025CBC6B98E3F1DB07B1D825CCC3ECFB88D98C5E4BAA2B16AEDCEB023DA599EBF0475DADA3AC5CC6F2B7BE8DF37AD39943BD3A23B28045A6FC77E6AC8B0815195C25B0401988CE9C2FC56314FA7F85AF0FE92F3059254514D1C861F4F03BE6017EF4254B0F3043AF5FE18E41F936701D8FDDEDF1DBC96661674DDA6D82DE5DBACE678C08788C2091038A0D1B9466F02F3081194030F802108219BEC6DB00569C1470909E58FEDC9E89C50FAB92EBDC81974F30D9A3A7958B7F749D9BF00506ED93068F9F93106B1EDE84B2024AF0E4CEFE0C9EC37D853687C5FB34FD25779DAF30AADEE64FE1A1D68DE626B7CD829B2C8DBFA611C1BB7EBEDDA445E69704A492970F20DB43C4E2B2F43A39D34A5F09C252F6CA2D6F2579EFC3C73015054FBA76F384F96BB8B6A4C970E9A7D4AF783444FC09FA63A5FF739A88D2C71D46E83FC6612D038F71167D03C7A2ADC780606B6F64404C6C954056CF35435FCA0CFDAEBF4390DDEF6AAD6C3CDB68EB686A0C5B8F37D41AB6064F6A0D5B53698A4CC33E293625C42D59D061433F176C33F352669B75D8E0E82853FB0AF2765B9BED0E23F68DC021EEB52D8FCAED6A8CC4DBEA9E4A31D1DC94B1DF22B762E5BA9A5D6FE5BD2855B5F51C2A2D9F31726A8EECB17C0B43CB3743E864A49EBC004A7577900852BA6A258464DFAF21889A24301A1D9E952C9B31DE9A22B4992A649924A6D30369B9690543AB9FE3BC15EF4115CECCC65BF520542F912154F9273542D5EB5109577DB4B5C1782B5B3154F3CC646C3A67758377273325F913A5634576DA083EC0081E9EAA85CCAD4D03FD3A083298E7A74B7E6BA24F08C30131516F402EB36D9A42D214C94A8FB555272B8C3136B1B6D7799EFA618509C5291223B2747D4C024797CFD552D0069A5810B0890D0FD8A8E28357EE1F043E29E011F23A78246665415E9C9F2F04A8D814C3ACB481205A63FE62E31E2648B4DB61E28707106910E0F6D8252825CBC921FC9B0FF00093D24E6BD839FA747208E788FAF8B3F428A1D0CB0A17B0A86E5715BD74F74B2986B9D0A85278BD182E78CE2EEF930FD89023E85CFBF5078F35C87D1088D605EB503081ACC9F136B96F651E62972F58E52DF6998BB9DCCB05637A4E4C469B655E762C1D6CFC974E517867C6EA9EADDAF1B52A2BCB3FC8C05458F65B02361B99CCC0B06E57CFBB53323034DE26A22C4F5E06EA347D17E30E3F821A3175749540C83F3176E2D0D6E90DA21405D0611A35545064F498DC94EA73B695A0C8E81E7BF8E4825247CD658F06DE01B3D6E2579585B2B040BA3784FA0496E6A6449137590E2F0025E40D440C59D83E75813A27558204B1001AF3266CAFE5A767731349CAF693D8BB070465620518D43B03282A08C266EAD2583E74456E6A89AC08CE4B504F8A43B025EC1664B027A9A120743CE7DD004B9701CD7CE550A45A17AA9B04EB14DECACB3489CEFB383890F8368397132E33EB7D111247703FB19C059F8950BA40A0BB65315E32899846DC321322F5316F00F1EC876E9174B503EF77E114BAC40C6B88967AEC11F7DD1667889B21EF965EDD3CD83C587A8A2EC3E51D381CC2644F751D364F9C4DDD72B8FE6163DF8A17D7303C3F9774E4116CC94928CDC01E726FF1D118D39B30CB51E9301F4159DE5B07B1B04C74AA0A4FD19EC7FA4DF1BA5A0FD2AE2F7FA6FD37D37FD97A59310269B6DF60DAE2327AA9EA9182C4881B9DB2F313442053F6ACACD3A88893BEA8A60F52FDB95984553F9764B01E4791104509AC13B214F6268CEE49A59876B724735E067724DFA6E22B292ED04CD5541C547048618086A3A9CA28F169CA170C3ACA92860A0A5DD7A021E9EB1D3A9C44C9EB9EDA4AF114FA409543198EABABA46A5892762F1AA6E4F5C9681A892BC72A9B224836D037E5CE635C1DD3862381766286B10BB4C6DE971292C18D69F6CE6D264FD1BC4D65BADB9A160D4655E77A53099C46FA060A9EB9CCD9F15305A5EB7DA0E1744F2DE4A4ED5160E4A47D680E876A25A021518F2D1C6ADB38C0F8D3F6A1BD46C9F5E92DE497CDA044216EB3C37E416D57AACCA02C839488625FE9D44A86B7EA023875BA1562CAB2AA85412FAB37BACF6DE6F6B32E2869BE4A5AB987ADE6AB9E9587A880E9BF68AAF8CF27F5A2D40AB93DBF84E80CC9F1B95C7ED9E4D5FD638542A25D2F711D8CFB73185449F66B8E605CEBC3E61FD13A0AB196760BEE4012EE608EEA1638F7F26271C90D269ECE90A097E74124A94B984C0ADE26017C59B9FF74FEF5B6D37C61C9FCDE463ECB6E5571802F790699FF0432A637EB8F176523BA16F6D8A1B8716CFEBE46D7AAAB1ED7BC3C0404DB8B3D0482D8893D148F5E91BC642572C80458859B5A10CB4D57CEEDDFB6EDBE33E73EC386EFCAB9C0426A79B63062627A38D938E674E5409A91B68B274C3049344EDFA71CF699C5B04AE67BA4BC5E4C6758752333C7B3AEDFD54C8BA99236DB9A30930A10DB1056A5BC43EDF2A4382D06E0A4B0F493E27539002F991B9C14A977039062E7354C71AA775948CED831997146629A6196598C313FBF3234C695881B3B77321D60615E840BA48CE21D762A643AE4F8698ED9730679A9C55C2ED5E512B903531731541B6C930A654542B57E4C7AC1B0C0DE08D95B22B90FDB0EF5AED4DE2DCDED2DC5C92DC7A5F1D80E7525A3B01DE28B19793A26B2431CB420CCC744B8DF794F3CFC44F29F81034A6C87E0B17A7DD51F73E79C6AFA9EC6988C6E6BD2EE7F499FDDD0A986C15371BFEDC1A4FF0F23596B92E69B1827D0C71DA5119549AA4B33A992E2EBF8AC2338C6E769BE3C1E576864DF2B4FCC021F53687EF3F6D78CF8BE2FD4B6E99D7D823724C53B7A70D33B42F9D6F6F8B8C1CD5B5864B378E2D73208397EF6F1980990B2C17FA6F94663FB7502038DE288067F63B26145CDAC62DD79B27283C714DF6F9D992B466BA4838CCA39461960F9BC8D62C45137E12803AE9CD21B38FF283BC36E3C52391DA9026D8EBB06F51ECC452D9F733893BB4BA6E7BC6F245318D53AADF94B231455EED3647E6FD484251999D30D5A2AFA21856883EF023621524AE3B424B6137D5A12E59D9593DCE39C245291E0D8F1D161F7379F904E3A202A99099DD5B0588C808AEDA0381CA0FE2F0A1C88E4E1BE0351FECF14496D1B3BA0ED9ADB6497B611098751BB84ABF5DF4104021C255C6728DC011FE1D73ECCF3EA2FBF7D035181977C8C1F61709BDC17E850204C328C1F23E6EF1196718DEEFC6ACE95C579797FA8DCF014246034434C02BC4FDE17611410BC6F249F0E1420CA80A9F9985DDE252A3F6AEF5F0924F18FD3A90035EC2371DE038C0F110696DF271BF00C87E08695EA13DC03FFB5EDEA5503E9BF0896EDCB0F21D86720CE1B18DD7EFC2B96E1207EF9F17FA5C88EC292650000 , N'6.4.4')

